<!DOCTYPE html>
<html lang="fa">

<head>
  <meta charset="UTF-8">
  <title>Three Cups Game</title>
  <link rel="stylesheet" href="style/master.css">
  <link rel="stylesheet" href="style/FontIcons/remixicon.css">
</head>

<body>

  <h2 id="status">ØªÙˆÙ¾ Ø±Ùˆ Ø¯Ù†Ø¨Ø§Ù„ Ú©Ù†...</h2>

  <div class="game">
    <div class="cup" data-index="0"></div>
    <div class="cup" data-index="1"></div>
    <div class="cup" data-index="2"></div>
  </div>

  <button id="start">Start Game</button>


  <div class="footer">
    <div><figure><img src="style/livanbazi.jpg" alt=""></figure></div>
    <div>
      <div><a href="https://github.com/sedaghat-frontdev"><i class="ri-github-line"></i></a></div>
      <div><a href="https://www.instagram.com/sedaghat-frontdev/"><i class="ri-instagram-line"></i></a></div>
      <div><a href="mailto:rezzasedaghat@gmail.com"><i class="ri-mail-line"></i></a></div>
    </div>
    <div>
      <div><h1>MohammadReza Sedaghat</h1></div>
      <div><h1>Sedaghat-FrontDev</h1></div>
      <div><h1>Hope you`ve enjoyed !</h1></div>
    </div>
  </div>

  <script>
    const cups = document.querySelectorAll('.cup');
    const statusText = document.getElementById('status');
    const startBtn = document.getElementById('start');

    let positions = [0, 160, 320];
    let ballCup = 0;

    let isShuffling = false;
    let gameRunning = false;
    let canChoose = false;

    let shuffleInterval;

    /* Ù…Ù‚Ø¯Ø§Ø±Ø¯Ù‡ÛŒ Ø§ÙˆÙ„ÛŒÙ‡ */
    cups.forEach((cup, i) => {
      cup.style.transform = `translateX(${positions[i]}px)`;
    });

    /* Ø´Ø±ÙˆØ¹ Ø¨Ø§Ø²ÛŒ */
    startBtn.addEventListener('click', () => {
      if (gameRunning) return; // â›” Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ø´Ø±ÙˆØ¹ Ø¯ÙˆØ¨Ø§Ø±Ù‡
      startGame();
    });

    function startGame() {
      gameRunning = true;
      canChoose = false;

      resetGame();

      ballCup = Math.floor(Math.random() * 3);
      statusText.textContent = 'ØªÙˆÙ¾ Ø±Ùˆ Ø¨Ø¨ÛŒÙ† ðŸ‘€';

      showBall(ballCup);

      setTimeout(() => {
        hideBalls();
        startShuffle();
      }, 3000);
    }

    /* Ø´Ø±ÙˆØ¹ shuffle */
    function startShuffle() {
      isShuffling = true;
      statusText.textContent = 'Ù„ÛŒÙˆØ§Ù†â€ŒÙ‡Ø§ Ø¯Ø§Ø±Ù† Ù‚Ø§Ø·ÛŒ Ù…ÛŒØ´Ù† ðŸ”„';

      shuffleInterval = setInterval(shuffleCups, 350);

      setTimeout(() => {
        clearInterval(shuffleInterval);
        isShuffling = false;
        canChoose = true; // âœ… Ø­Ø§Ù„Ø§ Ú©Ø§Ø±Ø¨Ø± Ù…ÛŒâ€ŒØªÙˆÙ†Ù‡ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†Ù‡
        statusText.textContent = 'Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù† ðŸ‘†';
      }, 10000);
    }

    /* Ø¬Ø§Ø¨Ø¬Ø§ÛŒÛŒ ÙˆØ§Ù‚Ø¹ÛŒ */
    function shuffleCups() {
      const order = [...positions].sort(() => Math.random() - 0.5);

      cups.forEach((cup, i) => {
        cup.style.transform = `translateX(${order[i]}px)`;
      });

      positions = order;
    }

    /* Ú©Ù„ÛŒÚ© Ø±ÙˆÛŒ Ù„ÛŒÙˆØ§Ù† */
    cups.forEach((cup, i) => {
      cup.addEventListener('click', () => {
        if (!canChoose) return; // â›” ÙˆØ³Ø· Ø¨Ø§Ø²ÛŒ ÛŒØ§ Ø¨Ø¹Ø¯ Ø§Ø² Ø§Ù†ØªØ®Ø§Ø¨
        canChoose = false;     // â›” ÙÙ‚Ø· ÛŒÚ© Ø¨Ø§Ø± Ø§Ø¬Ø§Ø²Ù‡ Ø§Ù†ØªØ®Ø§Ø¨

        cup.classList.add('lift');

        if (i === ballCup) {
          statusText.textContent = 'ðŸŽ‰ Ø¨Ø±Ø¯ÛŒ!';
        } else {
          statusText.textContent = 'âŒ Ø¨Ø§Ø®ØªÛŒ!';
        }

        revealBall();
        gameRunning = false; // âœ… Ø¨Ø§Ø²ÛŒ ØªÙ…ÙˆÙ… Ø´Ø¯
      });
    });

    /* ØªÙˆÙ¾ */
    function showBall(index) {
      const ball = document.createElement('div');
      ball.className = 'ball';
      cups[index].appendChild(ball);
    }

    function hideBalls() {
      cups.forEach(cup => (cup.innerHTML = ''));
    }

    function revealBall() {
      hideBalls();
      showBall(ballCup);
    }

    /* Ø±ÛŒØ³Øª */
    function resetGame() {
      clearInterval(shuffleInterval);

      positions = [0, 160, 320];

      cups.forEach((cup, i) => {
        cup.classList.remove('lift');
        cup.innerHTML = '';
        cup.style.transform = `translateX(${positions[i]}px)`;
      });

      isShuffling = false;
    }

  </script>
</body>

</html>